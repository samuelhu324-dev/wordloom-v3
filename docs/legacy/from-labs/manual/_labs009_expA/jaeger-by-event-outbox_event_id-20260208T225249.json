{"data":[{"traceID":"28ec82b706a3c93586f6638b15084aae","spans":[{"traceID":"28ec82b706a3c93586f6638b15084aae","spanID":"ed2211830778b594","operationName":"outbox.process","references":[{"refType":"CHILD_OF","traceID":"28ec82b706a3c93586f6638b15084aae","spanID":"6f0f05e1965bd9c8"}],"startTime":1770562217503485,"duration":2306280,"tags":[{"key":"otel.scope.name","type":"string","value":"wordloom.search_outbox_worker"},{"key":"span.kind","type":"string","value":"internal"},{"key":"wordloom.claim_batch_id","type":"string","value":"c2a14bf6-1915-4e99-90c1-f080678523ea"},{"key":"wordloom.entity_id","type":"string","value":"b272ce7e-8cab-4a56-8ec1-9b3f35fd6706"},{"key":"wordloom.entity_type","type":"string","value":"book"},{"key":"wordloom.obs_schema","type":"string","value":"labs-009-v2"},{"key":"wordloom.outbox_attempts","type":"int64","value":2},{"key":"wordloom.outbox_event_id","type":"string","value":"3295b534-7d52-4160-87b2-570b510d168e"},{"key":"wordloom.outbox_event_version","type":"int64","value":1},{"key":"wordloom.outbox_op","type":"string","value":"delete"},{"key":"wordloom.projection","type":"string","value":"search_index_to_elastic"},{"key":"wordloom.worker_id","type":"string","value":"labs-009-expA-w1"}],"logs":[],"processID":"p1","warnings":null},{"traceID":"28ec82b706a3c93586f6638b15084aae","spanID":"6f0f05e1965bd9c8","operationName":"projection.process_batch","references":[],"startTime":1770562217503387,"duration":2306657,"tags":[{"key":"attempt","type":"int64","value":2},{"key":"batch_size","type":"int64","value":1},{"key":"entity_type","type":"string","value":"book"},{"key":"failed_count","type":"int64","value":0},{"key":"ok_count","type":"int64","value":0},{"key":"op","type":"string","value":"delete"},{"key":"otel.scope.name","type":"string","value":"wordloom.search_outbox_worker"},{"key":"projection","type":"string","value":"search"},{"key":"reason","type":"string","value":"es_connect"},{"key":"result","type":"string","value":"retry"},{"key":"retry_count","type":"int64","value":1},{"key":"span.kind","type":"string","value":"internal"},{"key":"wordloom.claim_batch_id","type":"string","value":"c2a14bf6-1915-4e99-90c1-f080678523ea"},{"key":"wordloom.obs_schema","type":"string","value":"labs-009-v2"},{"key":"wordloom.projection","type":"string","value":"search_index_to_elastic"},{"key":"wordloom.worker_id","type":"string","value":"labs-009-expA-w1"}],"logs":[],"processID":"p1","warnings":null},{"traceID":"28ec82b706a3c93586f6638b15084aae","spanID":"ed2f0ea6f26bb332","operationName":"connect","references":[{"refType":"CHILD_OF","traceID":"28ec82b706a3c93586f6638b15084aae","spanID":"ed2211830778b594"}],"startTime":1770562217503746,"duration":646,"tags":[{"key":"db.name","type":"string","value":"wordloom_test"},{"key":"db.system","type":"string","value":"postgresql"},{"key":"db.user","type":"string","value":"wordloom"},{"key":"net.peer.name","type":"string","value":"localhost"},{"key":"net.peer.port","type":"int64","value":5435},{"key":"otel.scope.name","type":"string","value":"opentelemetry.instrumentation.sqlalchemy"},{"key":"otel.scope.version","type":"string","value":"0.60b1"},{"key":"span.kind","type":"string","value":"client"}],"logs":[],"processID":"p1","warnings":null},{"traceID":"28ec82b706a3c93586f6638b15084aae","spanID":"a8e281a5242fcb01","operationName":"SELECT wordloom_test","references":[{"refType":"CHILD_OF","traceID":"28ec82b706a3c93586f6638b15084aae","spanID":"ed2211830778b594"}],"startTime":1770562217504576,"duration":2431,"tags":[{"key":"db.name","type":"string","value":"wordloom_test"},{"key":"db.statement","type":"string","value":"SELECT search_outbox_events.id, search_outbox_events.entity_type, search_outbox_events.entity_id, search_outbox_events.op, search_outbox_events.event_version, search_outbox_events.created_at, search_outbox_events.status, search_outbox_events.owner, search_outbox_events.lease_until, search_outbox_events.attempts, search_outbox_events.next_retry_at, search_outbox_events.updated_at, search_outbox_events.processed_at, search_outbox_events.processing_started_at, search_outbox_events.error_reason, search_outbox_events.error, search_outbox_events.traceparent, search_outbox_events.tracestate, search_outbox_events.replay_count, search_outbox_events.last_replayed_at, search_outbox_events.last_replayed_by, search_outbox_events.last_replayed_reason \nFROM search_outbox_events \nWHERE search_outbox_events.id = %(id_1)s::UUID"},{"key":"db.system","type":"string","value":"postgresql"},{"key":"db.user","type":"string","value":"wordloom"},{"key":"net.peer.name","type":"string","value":"localhost"},{"key":"net.peer.port","type":"int64","value":5435},{"key":"otel.scope.name","type":"string","value":"opentelemetry.instrumentation.sqlalchemy"},{"key":"otel.scope.version","type":"string","value":"0.60b1"},{"key":"span.kind","type":"string","value":"client"}],"logs":[],"processID":"p1","warnings":null},{"traceID":"28ec82b706a3c93586f6638b15084aae","spanID":"bccbdccdff356d82","operationName":"UPDATE wordloom_test","references":[{"refType":"CHILD_OF","traceID":"28ec82b706a3c93586f6638b15084aae","spanID":"ed2211830778b594"}],"startTime":1770562219805832,"duration":2461,"tags":[{"key":"db.name","type":"string","value":"wordloom_test"},{"key":"db.statement","type":"string","value":"UPDATE search_outbox_events SET status=%(status)s::VARCHAR, owner=%(owner)s::VARCHAR, lease_until=%(lease_until)s::TIMESTAMP WITH TIME ZONE, attempts=%(attempts)s::INTEGER, next_retry_at=%(next_retry_at)s::TIMESTAMP WITH TIME ZONE, updated_at=%(updated_at)s::TIMESTAMP WITH TIME ZONE, processing_started_at=%(processing_started_at)s::TIMESTAMP WITH TIME ZONE, error_reason=%(error_reason)s::VARCHAR, error=%(error)s::VARCHAR WHERE search_outbox_events.id = %(id_1)s::UUID AND search_outbox_events.owner = %(owner_1)s::VARCHAR AND search_outbox_events.status = %(status_1)s::VARCHAR AND search_outbox_events.lease_until \u003e %(lease_until_1)s::TIMESTAMP WITH TIME ZONE"},{"key":"db.system","type":"string","value":"postgresql"},{"key":"db.user","type":"string","value":"wordloom"},{"key":"net.peer.name","type":"string","value":"localhost"},{"key":"net.peer.port","type":"int64","value":5435},{"key":"otel.scope.name","type":"string","value":"opentelemetry.instrumentation.sqlalchemy"},{"key":"otel.scope.version","type":"string","value":"0.60b1"},{"key":"span.kind","type":"string","value":"client"}],"logs":[],"processID":"p1","warnings":null},{"traceID":"28ec82b706a3c93586f6638b15084aae","spanID":"fadfb52da54511e6","operationName":"DELETE","references":[{"refType":"CHILD_OF","traceID":"28ec82b706a3c93586f6638b15084aae","spanID":"ed2211830778b594"}],"startTime":1770562217507817,"duration":2290989,"tags":[{"key":"error","type":"bool","value":true},{"key":"http.method","type":"string","value":"DELETE"},{"key":"http.url","type":"string","value":"http://localhost:9200/wordloom-test-search-index/_doc/book:b272ce7e-8cab-4a56-8ec1-9b3f35fd6706"},{"key":"otel.scope.name","type":"string","value":"opentelemetry.instrumentation.httpx"},{"key":"otel.scope.version","type":"string","value":"0.60b1"},{"key":"otel.status_code","type":"string","value":"ERROR"},{"key":"otel.status_description","type":"string","value":"ConnectError: All connection attempts failed"},{"key":"span.kind","type":"string","value":"client"}],"logs":[{"timestamp":1770562219798785,"fields":[{"key":"event","type":"string","value":"exception"},{"key":"exception.escaped","type":"string","value":"False"},{"key":"exception.message","type":"string","value":"All connection attempts failed"},{"key":"exception.stacktrace","type":"string","value":"Traceback (most recent call last):\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\httpx\\_transports\\default.py\", line 101, in map_httpcore_exceptions\n    yield\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\httpx\\_transports\\default.py\", line 394, in handle_async_request\n    resp = await self._pool.handle_async_request(req)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\httpcore\\_async\\connection_pool.py\", line 256, in handle_async_request\n    raise exc from None\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\httpcore\\_async\\connection_pool.py\", line 236, in handle_async_request\n    response = await connection.handle_async_request(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n        pool_request.request\n        ^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\httpcore\\_async\\connection.py\", line 101, in handle_async_request\n    raise exc\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\httpcore\\_async\\connection.py\", line 78, in handle_async_request\n    stream = await self._connect(request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\httpcore\\_async\\connection.py\", line 124, in _connect\n    stream = await self._network_backend.connect_tcp(**kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\httpcore\\_backends\\auto.py\", line 31, in connect_tcp\n    return await self._backend.connect_tcp(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...\u003c5 lines\u003e...\n    )\n    ^\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\httpcore\\_backends\\anyio.py\", line 113, in connect_tcp\n    with map_exceptions(exc_map):\n         ~~~~~~~~~~~~~~^^^^^^^^^\n  File \"C:\\Python314\\Lib\\contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\httpcore\\_exceptions.py\", line 14, in map_exceptions\n    raise to_exc(exc) from exc\nhttpcore.ConnectError: All connection attempts failed\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\opentelemetry\\trace\\__init__.py\", line 589, in use_span\n    yield span\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\opentelemetry\\sdk\\trace\\__init__.py\", line 1105, in start_as_current_span\n    yield span\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\opentelemetry\\instrumentation\\httpx\\__init__.py\", line 1241, in _handle_async_request_wrapper\n    raise exception.with_traceback(exception.__traceback__)\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\opentelemetry\\instrumentation\\httpx\\__init__.py\", line 1199, in _handle_async_request_wrapper\n    response = await wrapped(*args, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\httpx\\_transports\\default.py\", line 393, in handle_async_request\n    with map_httpcore_exceptions():\n         ~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"C:\\Python314\\Lib\\contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\httpx\\_transports\\default.py\", line 118, in map_httpcore_exceptions\n    raise mapped_exc(message) from exc\nhttpx.ConnectError: All connection attempts failed\n"},{"key":"exception.type","type":"string","value":"httpx.ConnectError"}]}],"processID":"p1","warnings":null}],"processes":{"p1":{"serviceName":"wordloom-search-outbox-worker","tags":[{"key":"telemetry.sdk.language","type":"string","value":"python"},{"key":"telemetry.sdk.name","type":"string","value":"opentelemetry"},{"key":"telemetry.sdk.version","type":"string","value":"1.39.1"}]}},"warnings":null},{"traceID":"9a0c8fad21715a3893fec116b06dbba8","spans":[{"traceID":"9a0c8fad21715a3893fec116b06dbba8","spanID":"e756b3db67d8b921","operationName":"connect","references":[{"refType":"CHILD_OF","traceID":"9a0c8fad21715a3893fec116b06dbba8","spanID":"32bce0a7b3de3604"}],"startTime":1770562344231643,"duration":456,"tags":[{"key":"db.name","type":"string","value":"wordloom_test"},{"key":"db.system","type":"string","value":"postgresql"},{"key":"db.user","type":"string","value":"wordloom"},{"key":"net.peer.name","type":"string","value":"localhost"},{"key":"net.peer.port","type":"int64","value":5435},{"key":"otel.scope.name","type":"string","value":"opentelemetry.instrumentation.sqlalchemy"},{"key":"otel.scope.version","type":"string","value":"0.60b1"},{"key":"span.kind","type":"string","value":"client"}],"logs":[],"processID":"p1","warnings":null},{"traceID":"9a0c8fad21715a3893fec116b06dbba8","spanID":"49e353b9b12f302a","operationName":"SELECT wordloom_test","references":[{"refType":"CHILD_OF","traceID":"9a0c8fad21715a3893fec116b06dbba8","spanID":"32bce0a7b3de3604"}],"startTime":1770562344232237,"duration":841,"tags":[{"key":"db.name","type":"string","value":"wordloom_test"},{"key":"db.statement","type":"string","value":"SELECT search_outbox_events.id, search_outbox_events.entity_type, search_outbox_events.entity_id, search_outbox_events.op, search_outbox_events.event_version, search_outbox_events.created_at, search_outbox_events.status, search_outbox_events.owner, search_outbox_events.lease_until, search_outbox_events.attempts, search_outbox_events.next_retry_at, search_outbox_events.updated_at, search_outbox_events.processed_at, search_outbox_events.processing_started_at, search_outbox_events.error_reason, search_outbox_events.error, search_outbox_events.traceparent, search_outbox_events.tracestate, search_outbox_events.replay_count, search_outbox_events.last_replayed_at, search_outbox_events.last_replayed_by, search_outbox_events.last_replayed_reason \nFROM search_outbox_events \nWHERE search_outbox_events.id = %(id_1)s::UUID"},{"key":"db.system","type":"string","value":"postgresql"},{"key":"db.user","type":"string","value":"wordloom"},{"key":"net.peer.name","type":"string","value":"localhost"},{"key":"net.peer.port","type":"int64","value":5435},{"key":"otel.scope.name","type":"string","value":"opentelemetry.instrumentation.sqlalchemy"},{"key":"otel.scope.version","type":"string","value":"0.60b1"},{"key":"span.kind","type":"string","value":"client"}],"logs":[],"processID":"p1","warnings":null},{"traceID":"9a0c8fad21715a3893fec116b06dbba8","spanID":"fa1801c25a4381a0","operationName":"DELETE","references":[{"refType":"CHILD_OF","traceID":"9a0c8fad21715a3893fec116b06dbba8","spanID":"32bce0a7b3de3604"}],"startTime":1770562344233470,"duration":2306310,"tags":[{"key":"error","type":"bool","value":true},{"key":"http.method","type":"string","value":"DELETE"},{"key":"http.url","type":"string","value":"http://localhost:9200/wordloom-test-search-index/_doc/book:b272ce7e-8cab-4a56-8ec1-9b3f35fd6706"},{"key":"otel.scope.name","type":"string","value":"opentelemetry.instrumentation.httpx"},{"key":"otel.scope.version","type":"string","value":"0.60b1"},{"key":"otel.status_code","type":"string","value":"ERROR"},{"key":"otel.status_description","type":"string","value":"ConnectError: All connection attempts failed"},{"key":"span.kind","type":"string","value":"client"}],"logs":[{"timestamp":1770562346539762,"fields":[{"key":"event","type":"string","value":"exception"},{"key":"exception.escaped","type":"string","value":"False"},{"key":"exception.message","type":"string","value":"All connection attempts failed"},{"key":"exception.stacktrace","type":"string","value":"Traceback (most recent call last):\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\httpx\\_transports\\default.py\", line 101, in map_httpcore_exceptions\n    yield\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\httpx\\_transports\\default.py\", line 394, in handle_async_request\n    resp = await self._pool.handle_async_request(req)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\httpcore\\_async\\connection_pool.py\", line 256, in handle_async_request\n    raise exc from None\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\httpcore\\_async\\connection_pool.py\", line 236, in handle_async_request\n    response = await connection.handle_async_request(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n        pool_request.request\n        ^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\httpcore\\_async\\connection.py\", line 101, in handle_async_request\n    raise exc\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\httpcore\\_async\\connection.py\", line 78, in handle_async_request\n    stream = await self._connect(request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\httpcore\\_async\\connection.py\", line 124, in _connect\n    stream = await self._network_backend.connect_tcp(**kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\httpcore\\_backends\\auto.py\", line 31, in connect_tcp\n    return await self._backend.connect_tcp(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...\u003c5 lines\u003e...\n    )\n    ^\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\httpcore\\_backends\\anyio.py\", line 113, in connect_tcp\n    with map_exceptions(exc_map):\n         ~~~~~~~~~~~~~~^^^^^^^^^\n  File \"C:\\Python314\\Lib\\contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\httpcore\\_exceptions.py\", line 14, in map_exceptions\n    raise to_exc(exc) from exc\nhttpcore.ConnectError: All connection attempts failed\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\opentelemetry\\trace\\__init__.py\", line 589, in use_span\n    yield span\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\opentelemetry\\sdk\\trace\\__init__.py\", line 1105, in start_as_current_span\n    yield span\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\opentelemetry\\instrumentation\\httpx\\__init__.py\", line 1241, in _handle_async_request_wrapper\n    raise exception.with_traceback(exception.__traceback__)\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\opentelemetry\\instrumentation\\httpx\\__init__.py\", line 1199, in _handle_async_request_wrapper\n    response = await wrapped(*args, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\httpx\\_transports\\default.py\", line 393, in handle_async_request\n    with map_httpcore_exceptions():\n         ~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"C:\\Python314\\Lib\\contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\httpx\\_transports\\default.py\", line 118, in map_httpcore_exceptions\n    raise mapped_exc(message) from exc\nhttpx.ConnectError: All connection attempts failed\n"},{"key":"exception.type","type":"string","value":"httpx.ConnectError"}]}],"processID":"p1","warnings":null},{"traceID":"9a0c8fad21715a3893fec116b06dbba8","spanID":"99450c16d47f2f0f","operationName":"UPDATE wordloom_test","references":[{"refType":"CHILD_OF","traceID":"9a0c8fad21715a3893fec116b06dbba8","spanID":"32bce0a7b3de3604"}],"startTime":1770562346544081,"duration":1409,"tags":[{"key":"db.name","type":"string","value":"wordloom_test"},{"key":"db.statement","type":"string","value":"UPDATE search_outbox_events SET status=%(status)s::VARCHAR, owner=%(owner)s::VARCHAR, lease_until=%(lease_until)s::TIMESTAMP WITH TIME ZONE, attempts=%(attempts)s::INTEGER, next_retry_at=%(next_retry_at)s::TIMESTAMP WITH TIME ZONE, updated_at=%(updated_at)s::TIMESTAMP WITH TIME ZONE, processing_started_at=%(processing_started_at)s::TIMESTAMP WITH TIME ZONE, error_reason=%(error_reason)s::VARCHAR, error=%(error)s::VARCHAR WHERE search_outbox_events.id = %(id_1)s::UUID AND search_outbox_events.owner = %(owner_1)s::VARCHAR AND search_outbox_events.status = %(status_1)s::VARCHAR AND search_outbox_events.lease_until \u003e %(lease_until_1)s::TIMESTAMP WITH TIME ZONE"},{"key":"db.system","type":"string","value":"postgresql"},{"key":"db.user","type":"string","value":"wordloom"},{"key":"net.peer.name","type":"string","value":"localhost"},{"key":"net.peer.port","type":"int64","value":5435},{"key":"otel.scope.name","type":"string","value":"opentelemetry.instrumentation.sqlalchemy"},{"key":"otel.scope.version","type":"string","value":"0.60b1"},{"key":"span.kind","type":"string","value":"client"}],"logs":[],"processID":"p1","warnings":null},{"traceID":"9a0c8fad21715a3893fec116b06dbba8","spanID":"32bce0a7b3de3604","operationName":"outbox.process","references":[{"refType":"CHILD_OF","traceID":"9a0c8fad21715a3893fec116b06dbba8","spanID":"96addb22d8dd871f"}],"startTime":1770562344231482,"duration":2315849,"tags":[{"key":"otel.scope.name","type":"string","value":"wordloom.search_outbox_worker"},{"key":"span.kind","type":"string","value":"internal"},{"key":"wordloom.claim_batch_id","type":"string","value":"c7134ccf-1346-41b0-bfb2-46cced5335c5"},{"key":"wordloom.entity_id","type":"string","value":"b272ce7e-8cab-4a56-8ec1-9b3f35fd6706"},{"key":"wordloom.entity_type","type":"string","value":"book"},{"key":"wordloom.obs_schema","type":"string","value":"labs-009-v2"},{"key":"wordloom.outbox_attempts","type":"int64","value":8},{"key":"wordloom.outbox_event_id","type":"string","value":"3295b534-7d52-4160-87b2-570b510d168e"},{"key":"wordloom.outbox_event_version","type":"int64","value":1},{"key":"wordloom.outbox_op","type":"string","value":"delete"},{"key":"wordloom.projection","type":"string","value":"search_index_to_elastic"},{"key":"wordloom.worker_id","type":"string","value":"labs-009-expA-w1"}],"logs":[],"processID":"p1","warnings":null},{"traceID":"9a0c8fad21715a3893fec116b06dbba8","spanID":"96addb22d8dd871f","operationName":"projection.process_batch","references":[],"startTime":1770562344231430,"duration":2316357,"tags":[{"key":"attempt","type":"int64","value":8},{"key":"batch_size","type":"int64","value":1},{"key":"entity_type","type":"string","value":"book"},{"key":"failed_count","type":"int64","value":0},{"key":"ok_count","type":"int64","value":0},{"key":"op","type":"string","value":"delete"},{"key":"otel.scope.name","type":"string","value":"wordloom.search_outbox_worker"},{"key":"projection","type":"string","value":"search"},{"key":"reason","type":"string","value":"es_connect"},{"key":"result","type":"string","value":"retry"},{"key":"retry_count","type":"int64","value":1},{"key":"span.kind","type":"string","value":"internal"},{"key":"wordloom.claim_batch_id","type":"string","value":"c7134ccf-1346-41b0-bfb2-46cced5335c5"},{"key":"wordloom.obs_schema","type":"string","value":"labs-009-v2"},{"key":"wordloom.projection","type":"string","value":"search_index_to_elastic"},{"key":"wordloom.worker_id","type":"string","value":"labs-009-expA-w1"}],"logs":[],"processID":"p1","warnings":null}],"processes":{"p1":{"serviceName":"wordloom-search-outbox-worker","tags":[{"key":"telemetry.sdk.language","type":"string","value":"python"},{"key":"telemetry.sdk.name","type":"string","value":"opentelemetry"},{"key":"telemetry.sdk.version","type":"string","value":"1.39.1"}]}},"warnings":null},{"traceID":"e8dc8eb7d85999c8cca83ba714b94b86","spans":[{"traceID":"e8dc8eb7d85999c8cca83ba714b94b86","spanID":"c1d51f96ebc0a976","operationName":"projection.process_batch","references":[],"startTime":1770562211474728,"duration":2340451,"tags":[{"key":"attempt","type":"int64","value":0},{"key":"batch_size","type":"int64","value":1},{"key":"entity_type","type":"string","value":"book"},{"key":"failed_count","type":"int64","value":0},{"key":"ok_count","type":"int64","value":0},{"key":"op","type":"string","value":"delete"},{"key":"otel.scope.name","type":"string","value":"wordloom.search_outbox_worker"},{"key":"projection","type":"string","value":"search"},{"key":"reason","type":"string","value":"es_connect"},{"key":"result","type":"string","value":"retry"},{"key":"retry_count","type":"int64","value":1},{"key":"span.kind","type":"string","value":"internal"},{"key":"wordloom.claim_batch_id","type":"string","value":"0f994890-f10e-4d1f-8b95-d31350e1769f"},{"key":"wordloom.obs_schema","type":"string","value":"labs-009-v2"},{"key":"wordloom.projection","type":"string","value":"search_index_to_elastic"},{"key":"wordloom.worker_id","type":"string","value":"labs-009-expA-w1"}],"logs":[],"processID":"p1","warnings":null},{"traceID":"e8dc8eb7d85999c8cca83ba714b94b86","spanID":"893f0aae1879bed0","operationName":"DELETE","references":[{"refType":"CHILD_OF","traceID":"e8dc8eb7d85999c8cca83ba714b94b86","spanID":"89bbfdce8ce43304"}],"startTime":1770562211481317,"duration":2322183,"tags":[{"key":"error","type":"bool","value":true},{"key":"http.method","type":"string","value":"DELETE"},{"key":"http.url","type":"string","value":"http://localhost:9200/wordloom-test-search-index/_doc/book:b272ce7e-8cab-4a56-8ec1-9b3f35fd6706"},{"key":"otel.scope.name","type":"string","value":"opentelemetry.instrumentation.httpx"},{"key":"otel.scope.version","type":"string","value":"0.60b1"},{"key":"otel.status_code","type":"string","value":"ERROR"},{"key":"otel.status_description","type":"string","value":"ConnectError: All connection attempts failed"},{"key":"span.kind","type":"string","value":"client"}],"logs":[{"timestamp":1770562213803472,"fields":[{"key":"event","type":"string","value":"exception"},{"key":"exception.escaped","type":"string","value":"False"},{"key":"exception.message","type":"string","value":"All connection attempts failed"},{"key":"exception.stacktrace","type":"string","value":"Traceback (most recent call last):\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\httpx\\_transports\\default.py\", line 101, in map_httpcore_exceptions\n    yield\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\httpx\\_transports\\default.py\", line 394, in handle_async_request\n    resp = await self._pool.handle_async_request(req)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\httpcore\\_async\\connection_pool.py\", line 256, in handle_async_request\n    raise exc from None\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\httpcore\\_async\\connection_pool.py\", line 236, in handle_async_request\n    response = await connection.handle_async_request(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n        pool_request.request\n        ^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\httpcore\\_async\\connection.py\", line 101, in handle_async_request\n    raise exc\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\httpcore\\_async\\connection.py\", line 78, in handle_async_request\n    stream = await self._connect(request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\httpcore\\_async\\connection.py\", line 124, in _connect\n    stream = await self._network_backend.connect_tcp(**kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\httpcore\\_backends\\auto.py\", line 31, in connect_tcp\n    return await self._backend.connect_tcp(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...\u003c5 lines\u003e...\n    )\n    ^\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\httpcore\\_backends\\anyio.py\", line 113, in connect_tcp\n    with map_exceptions(exc_map):\n         ~~~~~~~~~~~~~~^^^^^^^^^\n  File \"C:\\Python314\\Lib\\contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\httpcore\\_exceptions.py\", line 14, in map_exceptions\n    raise to_exc(exc) from exc\nhttpcore.ConnectError: All connection attempts failed\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\opentelemetry\\trace\\__init__.py\", line 589, in use_span\n    yield span\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\opentelemetry\\sdk\\trace\\__init__.py\", line 1105, in start_as_current_span\n    yield span\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\opentelemetry\\instrumentation\\httpx\\__init__.py\", line 1241, in _handle_async_request_wrapper\n    raise exception.with_traceback(exception.__traceback__)\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\opentelemetry\\instrumentation\\httpx\\__init__.py\", line 1199, in _handle_async_request_wrapper\n    response = await wrapped(*args, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\httpx\\_transports\\default.py\", line 393, in handle_async_request\n    with map_httpcore_exceptions():\n         ~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"C:\\Python314\\Lib\\contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\httpx\\_transports\\default.py\", line 118, in map_httpcore_exceptions\n    raise mapped_exc(message) from exc\nhttpx.ConnectError: All connection attempts failed\n"},{"key":"exception.type","type":"string","value":"httpx.ConnectError"}]}],"processID":"p1","warnings":null},{"traceID":"e8dc8eb7d85999c8cca83ba714b94b86","spanID":"d7798d189fa54dd4","operationName":"connect","references":[{"refType":"CHILD_OF","traceID":"e8dc8eb7d85999c8cca83ba714b94b86","spanID":"89bbfdce8ce43304"}],"startTime":1770562211475071,"duration":1067,"tags":[{"key":"db.name","type":"string","value":"wordloom_test"},{"key":"db.system","type":"string","value":"postgresql"},{"key":"db.user","type":"string","value":"wordloom"},{"key":"net.peer.name","type":"string","value":"localhost"},{"key":"net.peer.port","type":"int64","value":5435},{"key":"otel.scope.name","type":"string","value":"opentelemetry.instrumentation.sqlalchemy"},{"key":"otel.scope.version","type":"string","value":"0.60b1"},{"key":"span.kind","type":"string","value":"client"}],"logs":[],"processID":"p1","warnings":null},{"traceID":"e8dc8eb7d85999c8cca83ba714b94b86","spanID":"099d86d3139e8038","operationName":"SELECT wordloom_test","references":[{"refType":"CHILD_OF","traceID":"e8dc8eb7d85999c8cca83ba714b94b86","spanID":"89bbfdce8ce43304"}],"startTime":1770562211476733,"duration":3573,"tags":[{"key":"db.name","type":"string","value":"wordloom_test"},{"key":"db.statement","type":"string","value":"SELECT search_outbox_events.id, search_outbox_events.entity_type, search_outbox_events.entity_id, search_outbox_events.op, search_outbox_events.event_version, search_outbox_events.created_at, search_outbox_events.status, search_outbox_events.owner, search_outbox_events.lease_until, search_outbox_events.attempts, search_outbox_events.next_retry_at, search_outbox_events.updated_at, search_outbox_events.processed_at, search_outbox_events.processing_started_at, search_outbox_events.error_reason, search_outbox_events.error, search_outbox_events.traceparent, search_outbox_events.tracestate, search_outbox_events.replay_count, search_outbox_events.last_replayed_at, search_outbox_events.last_replayed_by, search_outbox_events.last_replayed_reason \nFROM search_outbox_events \nWHERE search_outbox_events.id = %(id_1)s::UUID"},{"key":"db.system","type":"string","value":"postgresql"},{"key":"db.user","type":"string","value":"wordloom"},{"key":"net.peer.name","type":"string","value":"localhost"},{"key":"net.peer.port","type":"int64","value":5435},{"key":"otel.scope.name","type":"string","value":"opentelemetry.instrumentation.sqlalchemy"},{"key":"otel.scope.version","type":"string","value":"0.60b1"},{"key":"span.kind","type":"string","value":"client"}],"logs":[],"processID":"p1","warnings":null},{"traceID":"e8dc8eb7d85999c8cca83ba714b94b86","spanID":"956b81bc90d565a4","operationName":"UPDATE wordloom_test","references":[{"refType":"CHILD_OF","traceID":"e8dc8eb7d85999c8cca83ba714b94b86","spanID":"89bbfdce8ce43304"}],"startTime":1770562213808576,"duration":3844,"tags":[{"key":"db.name","type":"string","value":"wordloom_test"},{"key":"db.statement","type":"string","value":"UPDATE search_outbox_events SET status=%(status)s::VARCHAR, owner=%(owner)s::VARCHAR, lease_until=%(lease_until)s::TIMESTAMP WITH TIME ZONE, attempts=%(attempts)s::INTEGER, next_retry_at=%(next_retry_at)s::TIMESTAMP WITH TIME ZONE, updated_at=%(updated_at)s::TIMESTAMP WITH TIME ZONE, processing_started_at=%(processing_started_at)s::TIMESTAMP WITH TIME ZONE, error_reason=%(error_reason)s::VARCHAR, error=%(error)s::VARCHAR WHERE search_outbox_events.id = %(id_1)s::UUID AND search_outbox_events.owner = %(owner_1)s::VARCHAR AND search_outbox_events.status = %(status_1)s::VARCHAR AND search_outbox_events.lease_until \u003e %(lease_until_1)s::TIMESTAMP WITH TIME ZONE"},{"key":"db.system","type":"string","value":"postgresql"},{"key":"db.user","type":"string","value":"wordloom"},{"key":"net.peer.name","type":"string","value":"localhost"},{"key":"net.peer.port","type":"int64","value":5435},{"key":"otel.scope.name","type":"string","value":"opentelemetry.instrumentation.sqlalchemy"},{"key":"otel.scope.version","type":"string","value":"0.60b1"},{"key":"span.kind","type":"string","value":"client"}],"logs":[],"processID":"p1","warnings":null},{"traceID":"e8dc8eb7d85999c8cca83ba714b94b86","spanID":"89bbfdce8ce43304","operationName":"outbox.process","references":[{"refType":"CHILD_OF","traceID":"e8dc8eb7d85999c8cca83ba714b94b86","spanID":"c1d51f96ebc0a976"}],"startTime":1770562211474792,"duration":2339786,"tags":[{"key":"otel.scope.name","type":"string","value":"wordloom.search_outbox_worker"},{"key":"span.kind","type":"string","value":"internal"},{"key":"wordloom.claim_batch_id","type":"string","value":"0f994890-f10e-4d1f-8b95-d31350e1769f"},{"key":"wordloom.entity_id","type":"string","value":"b272ce7e-8cab-4a56-8ec1-9b3f35fd6706"},{"key":"wordloom.entity_type","type":"string","value":"book"},{"key":"wordloom.obs_schema","type":"string","value":"labs-009-v2"},{"key":"wordloom.outbox_attempts","type":"int64","value":0},{"key":"wordloom.outbox_event_id","type":"string","value":"3295b534-7d52-4160-87b2-570b510d168e"},{"key":"wordloom.outbox_event_version","type":"int64","value":1},{"key":"wordloom.outbox_op","type":"string","value":"delete"},{"key":"wordloom.projection","type":"string","value":"search_index_to_elastic"},{"key":"wordloom.worker_id","type":"string","value":"labs-009-expA-w1"}],"logs":[],"processID":"p1","warnings":null}],"processes":{"p1":{"serviceName":"wordloom-search-outbox-worker","tags":[{"key":"telemetry.sdk.language","type":"string","value":"python"},{"key":"telemetry.sdk.name","type":"string","value":"opentelemetry"},{"key":"telemetry.sdk.version","type":"string","value":"1.39.1"}]}},"warnings":null},{"traceID":"2386dd60245ce140c23a86a9cd2258d4","spans":[{"traceID":"2386dd60245ce140c23a86a9cd2258d4","spanID":"19702dce7f425abd","operationName":"SELECT wordloom_test","references":[{"refType":"CHILD_OF","traceID":"2386dd60245ce140c23a86a9cd2258d4","spanID":"13618e4afb740e68"}],"startTime":1770562224000341,"duration":992,"tags":[{"key":"db.name","type":"string","value":"wordloom_test"},{"key":"db.statement","type":"string","value":"SELECT search_outbox_events.id, search_outbox_events.entity_type, search_outbox_events.entity_id, search_outbox_events.op, search_outbox_events.event_version, search_outbox_events.created_at, search_outbox_events.status, search_outbox_events.owner, search_outbox_events.lease_until, search_outbox_events.attempts, search_outbox_events.next_retry_at, search_outbox_events.updated_at, search_outbox_events.processed_at, search_outbox_events.processing_started_at, search_outbox_events.error_reason, search_outbox_events.error, search_outbox_events.traceparent, search_outbox_events.tracestate, search_outbox_events.replay_count, search_outbox_events.last_replayed_at, search_outbox_events.last_replayed_by, search_outbox_events.last_replayed_reason \nFROM search_outbox_events \nWHERE search_outbox_events.id = %(id_1)s::UUID"},{"key":"db.system","type":"string","value":"postgresql"},{"key":"db.user","type":"string","value":"wordloom"},{"key":"net.peer.name","type":"string","value":"localhost"},{"key":"net.peer.port","type":"int64","value":5435},{"key":"otel.scope.name","type":"string","value":"opentelemetry.instrumentation.sqlalchemy"},{"key":"otel.scope.version","type":"string","value":"0.60b1"},{"key":"span.kind","type":"string","value":"client"}],"logs":[],"processID":"p1","warnings":null},{"traceID":"2386dd60245ce140c23a86a9cd2258d4","spanID":"ab30ba927464e77d","operationName":"DELETE","references":[{"refType":"CHILD_OF","traceID":"2386dd60245ce140c23a86a9cd2258d4","spanID":"13618e4afb740e68"}],"startTime":1770562224001760,"duration":2298260,"tags":[{"key":"error","type":"bool","value":true},{"key":"http.method","type":"string","value":"DELETE"},{"key":"http.url","type":"string","value":"http://localhost:9200/wordloom-test-search-index/_doc/book:b272ce7e-8cab-4a56-8ec1-9b3f35fd6706"},{"key":"otel.scope.name","type":"string","value":"opentelemetry.instrumentation.httpx"},{"key":"otel.scope.version","type":"string","value":"0.60b1"},{"key":"otel.status_code","type":"string","value":"ERROR"},{"key":"otel.status_description","type":"string","value":"ConnectError: All connection attempts failed"},{"key":"span.kind","type":"string","value":"client"}],"logs":[{"timestamp":1770562226299998,"fields":[{"key":"event","type":"string","value":"exception"},{"key":"exception.escaped","type":"string","value":"False"},{"key":"exception.message","type":"string","value":"All connection attempts failed"},{"key":"exception.stacktrace","type":"string","value":"Traceback (most recent call last):\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\httpx\\_transports\\default.py\", line 101, in map_httpcore_exceptions\n    yield\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\httpx\\_transports\\default.py\", line 394, in handle_async_request\n    resp = await self._pool.handle_async_request(req)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\httpcore\\_async\\connection_pool.py\", line 256, in handle_async_request\n    raise exc from None\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\httpcore\\_async\\connection_pool.py\", line 236, in handle_async_request\n    response = await connection.handle_async_request(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n        pool_request.request\n        ^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\httpcore\\_async\\connection.py\", line 101, in handle_async_request\n    raise exc\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\httpcore\\_async\\connection.py\", line 78, in handle_async_request\n    stream = await self._connect(request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\httpcore\\_async\\connection.py\", line 124, in _connect\n    stream = await self._network_backend.connect_tcp(**kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\httpcore\\_backends\\auto.py\", line 31, in connect_tcp\n    return await self._backend.connect_tcp(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...\u003c5 lines\u003e...\n    )\n    ^\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\httpcore\\_backends\\anyio.py\", line 113, in connect_tcp\n    with map_exceptions(exc_map):\n         ~~~~~~~~~~~~~~^^^^^^^^^\n  File \"C:\\Python314\\Lib\\contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\httpcore\\_exceptions.py\", line 14, in map_exceptions\n    raise to_exc(exc) from exc\nhttpcore.ConnectError: All connection attempts failed\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\opentelemetry\\trace\\__init__.py\", line 589, in use_span\n    yield span\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\opentelemetry\\sdk\\trace\\__init__.py\", line 1105, in start_as_current_span\n    yield span\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\opentelemetry\\instrumentation\\httpx\\__init__.py\", line 1241, in _handle_async_request_wrapper\n    raise exception.with_traceback(exception.__traceback__)\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\opentelemetry\\instrumentation\\httpx\\__init__.py\", line 1199, in _handle_async_request_wrapper\n    response = await wrapped(*args, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\httpx\\_transports\\default.py\", line 393, in handle_async_request\n    with map_httpcore_exceptions():\n         ~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"C:\\Python314\\Lib\\contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\httpx\\_transports\\default.py\", line 118, in map_httpcore_exceptions\n    raise mapped_exc(message) from exc\nhttpx.ConnectError: All connection attempts failed\n"},{"key":"exception.type","type":"string","value":"httpx.ConnectError"}]}],"processID":"p1","warnings":null},{"traceID":"2386dd60245ce140c23a86a9cd2258d4","spanID":"3c025f721bf81e6c","operationName":"UPDATE wordloom_test","references":[{"refType":"CHILD_OF","traceID":"2386dd60245ce140c23a86a9cd2258d4","spanID":"13618e4afb740e68"}],"startTime":1770562226307486,"duration":2217,"tags":[{"key":"db.name","type":"string","value":"wordloom_test"},{"key":"db.statement","type":"string","value":"UPDATE search_outbox_events SET status=%(status)s::VARCHAR, owner=%(owner)s::VARCHAR, lease_until=%(lease_until)s::TIMESTAMP WITH TIME ZONE, attempts=%(attempts)s::INTEGER, next_retry_at=%(next_retry_at)s::TIMESTAMP WITH TIME ZONE, updated_at=%(updated_at)s::TIMESTAMP WITH TIME ZONE, processing_started_at=%(processing_started_at)s::TIMESTAMP WITH TIME ZONE, error_reason=%(error_reason)s::VARCHAR, error=%(error)s::VARCHAR WHERE search_outbox_events.id = %(id_1)s::UUID AND search_outbox_events.owner = %(owner_1)s::VARCHAR AND search_outbox_events.status = %(status_1)s::VARCHAR AND search_outbox_events.lease_until \u003e %(lease_until_1)s::TIMESTAMP WITH TIME ZONE"},{"key":"db.system","type":"string","value":"postgresql"},{"key":"db.user","type":"string","value":"wordloom"},{"key":"net.peer.name","type":"string","value":"localhost"},{"key":"net.peer.port","type":"int64","value":5435},{"key":"otel.scope.name","type":"string","value":"opentelemetry.instrumentation.sqlalchemy"},{"key":"otel.scope.version","type":"string","value":"0.60b1"},{"key":"span.kind","type":"string","value":"client"}],"logs":[],"processID":"p1","warnings":null},{"traceID":"2386dd60245ce140c23a86a9cd2258d4","spanID":"13618e4afb740e68","operationName":"outbox.process","references":[{"refType":"CHILD_OF","traceID":"2386dd60245ce140c23a86a9cd2258d4","spanID":"f483f9572ddbdefc"}],"startTime":1770562223999027,"duration":2312608,"tags":[{"key":"otel.scope.name","type":"string","value":"wordloom.search_outbox_worker"},{"key":"span.kind","type":"string","value":"internal"},{"key":"wordloom.claim_batch_id","type":"string","value":"83b057bc-e57e-416f-818a-42e3bc627039"},{"key":"wordloom.entity_id","type":"string","value":"b272ce7e-8cab-4a56-8ec1-9b3f35fd6706"},{"key":"wordloom.entity_type","type":"string","value":"book"},{"key":"wordloom.obs_schema","type":"string","value":"labs-009-v2"},{"key":"wordloom.outbox_attempts","type":"int64","value":3},{"key":"wordloom.outbox_event_id","type":"string","value":"3295b534-7d52-4160-87b2-570b510d168e"},{"key":"wordloom.outbox_event_version","type":"int64","value":1},{"key":"wordloom.outbox_op","type":"string","value":"delete"},{"key":"wordloom.projection","type":"string","value":"search_index_to_elastic"},{"key":"wordloom.worker_id","type":"string","value":"labs-009-expA-w1"}],"logs":[],"processID":"p1","warnings":null},{"traceID":"2386dd60245ce140c23a86a9cd2258d4","spanID":"f483f9572ddbdefc","operationName":"projection.process_batch","references":[],"startTime":1770562223998944,"duration":2313288,"tags":[{"key":"attempt","type":"int64","value":3},{"key":"batch_size","type":"int64","value":1},{"key":"entity_type","type":"string","value":"book"},{"key":"failed_count","type":"int64","value":0},{"key":"ok_count","type":"int64","value":0},{"key":"op","type":"string","value":"delete"},{"key":"otel.scope.name","type":"string","value":"wordloom.search_outbox_worker"},{"key":"projection","type":"string","value":"search"},{"key":"reason","type":"string","value":"es_connect"},{"key":"result","type":"string","value":"retry"},{"key":"retry_count","type":"int64","value":1},{"key":"span.kind","type":"string","value":"internal"},{"key":"wordloom.claim_batch_id","type":"string","value":"83b057bc-e57e-416f-818a-42e3bc627039"},{"key":"wordloom.obs_schema","type":"string","value":"labs-009-v2"},{"key":"wordloom.projection","type":"string","value":"search_index_to_elastic"},{"key":"wordloom.worker_id","type":"string","value":"labs-009-expA-w1"}],"logs":[],"processID":"p1","warnings":null},{"traceID":"2386dd60245ce140c23a86a9cd2258d4","spanID":"1b53d31bc6454ac2","operationName":"connect","references":[{"refType":"CHILD_OF","traceID":"2386dd60245ce140c23a86a9cd2258d4","spanID":"13618e4afb740e68"}],"startTime":1770562223999320,"duration":842,"tags":[{"key":"db.name","type":"string","value":"wordloom_test"},{"key":"db.system","type":"string","value":"postgresql"},{"key":"db.user","type":"string","value":"wordloom"},{"key":"net.peer.name","type":"string","value":"localhost"},{"key":"net.peer.port","type":"int64","value":5435},{"key":"otel.scope.name","type":"string","value":"opentelemetry.instrumentation.sqlalchemy"},{"key":"otel.scope.version","type":"string","value":"0.60b1"},{"key":"span.kind","type":"string","value":"client"}],"logs":[],"processID":"p1","warnings":null}],"processes":{"p1":{"serviceName":"wordloom-search-outbox-worker","tags":[{"key":"telemetry.sdk.language","type":"string","value":"python"},{"key":"telemetry.sdk.name","type":"string","value":"opentelemetry"},{"key":"telemetry.sdk.version","type":"string","value":"1.39.1"}]}},"warnings":null},{"traceID":"02c1b9f614e2439724b61a50775aa44c","spans":[{"traceID":"02c1b9f614e2439724b61a50775aa44c","spanID":"2a67d65549494b8a","operationName":"SELECT wordloom_test","references":[{"refType":"CHILD_OF","traceID":"02c1b9f614e2439724b61a50775aa44c","spanID":"9a98f46e04018964"}],"startTime":1770562251418560,"duration":949,"tags":[{"key":"db.name","type":"string","value":"wordloom_test"},{"key":"db.statement","type":"string","value":"SELECT search_outbox_events.id, search_outbox_events.entity_type, search_outbox_events.entity_id, search_outbox_events.op, search_outbox_events.event_version, search_outbox_events.created_at, search_outbox_events.status, search_outbox_events.owner, search_outbox_events.lease_until, search_outbox_events.attempts, search_outbox_events.next_retry_at, search_outbox_events.updated_at, search_outbox_events.processed_at, search_outbox_events.processing_started_at, search_outbox_events.error_reason, search_outbox_events.error, search_outbox_events.traceparent, search_outbox_events.tracestate, search_outbox_events.replay_count, search_outbox_events.last_replayed_at, search_outbox_events.last_replayed_by, search_outbox_events.last_replayed_reason \nFROM search_outbox_events \nWHERE search_outbox_events.id = %(id_1)s::UUID"},{"key":"db.system","type":"string","value":"postgresql"},{"key":"db.user","type":"string","value":"wordloom"},{"key":"net.peer.name","type":"string","value":"localhost"},{"key":"net.peer.port","type":"int64","value":5435},{"key":"otel.scope.name","type":"string","value":"opentelemetry.instrumentation.sqlalchemy"},{"key":"otel.scope.version","type":"string","value":"0.60b1"},{"key":"span.kind","type":"string","value":"client"}],"logs":[],"processID":"p1","warnings":null},{"traceID":"02c1b9f614e2439724b61a50775aa44c","spanID":"c6fd078da2aec297","operationName":"UPDATE wordloom_test","references":[{"refType":"CHILD_OF","traceID":"02c1b9f614e2439724b61a50775aa44c","spanID":"9a98f46e04018964"}],"startTime":1770562253724726,"duration":1480,"tags":[{"key":"db.name","type":"string","value":"wordloom_test"},{"key":"db.statement","type":"string","value":"UPDATE search_outbox_events SET status=%(status)s::VARCHAR, owner=%(owner)s::VARCHAR, lease_until=%(lease_until)s::TIMESTAMP WITH TIME ZONE, attempts=%(attempts)s::INTEGER, next_retry_at=%(next_retry_at)s::TIMESTAMP WITH TIME ZONE, updated_at=%(updated_at)s::TIMESTAMP WITH TIME ZONE, processing_started_at=%(processing_started_at)s::TIMESTAMP WITH TIME ZONE, error_reason=%(error_reason)s::VARCHAR, error=%(error)s::VARCHAR WHERE search_outbox_events.id = %(id_1)s::UUID AND search_outbox_events.owner = %(owner_1)s::VARCHAR AND search_outbox_events.status = %(status_1)s::VARCHAR AND search_outbox_events.lease_until \u003e %(lease_until_1)s::TIMESTAMP WITH TIME ZONE"},{"key":"db.system","type":"string","value":"postgresql"},{"key":"db.user","type":"string","value":"wordloom"},{"key":"net.peer.name","type":"string","value":"localhost"},{"key":"net.peer.port","type":"int64","value":5435},{"key":"otel.scope.name","type":"string","value":"opentelemetry.instrumentation.sqlalchemy"},{"key":"otel.scope.version","type":"string","value":"0.60b1"},{"key":"span.kind","type":"string","value":"client"}],"logs":[],"processID":"p1","warnings":null},{"traceID":"02c1b9f614e2439724b61a50775aa44c","spanID":"309b6c2ccbcc65dc","operationName":"DELETE","references":[{"refType":"CHILD_OF","traceID":"02c1b9f614e2439724b61a50775aa44c","spanID":"9a98f46e04018964"}],"startTime":1770562251419936,"duration":2301445,"tags":[{"key":"error","type":"bool","value":true},{"key":"http.method","type":"string","value":"DELETE"},{"key":"http.url","type":"string","value":"http://localhost:9200/wordloom-test-search-index/_doc/book:b272ce7e-8cab-4a56-8ec1-9b3f35fd6706"},{"key":"otel.scope.name","type":"string","value":"opentelemetry.instrumentation.httpx"},{"key":"otel.scope.version","type":"string","value":"0.60b1"},{"key":"otel.status_code","type":"string","value":"ERROR"},{"key":"otel.status_description","type":"string","value":"ConnectError: All connection attempts failed"},{"key":"span.kind","type":"string","value":"client"}],"logs":[{"timestamp":1770562253721366,"fields":[{"key":"event","type":"string","value":"exception"},{"key":"exception.escaped","type":"string","value":"False"},{"key":"exception.message","type":"string","value":"All connection attempts failed"},{"key":"exception.stacktrace","type":"string","value":"Traceback (most recent call last):\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\httpx\\_transports\\default.py\", line 101, in map_httpcore_exceptions\n    yield\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\httpx\\_transports\\default.py\", line 394, in handle_async_request\n    resp = await self._pool.handle_async_request(req)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\httpcore\\_async\\connection_pool.py\", line 256, in handle_async_request\n    raise exc from None\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\httpcore\\_async\\connection_pool.py\", line 236, in handle_async_request\n    response = await connection.handle_async_request(\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n        pool_request.request\n        ^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\httpcore\\_async\\connection.py\", line 101, in handle_async_request\n    raise exc\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\httpcore\\_async\\connection.py\", line 78, in handle_async_request\n    stream = await self._connect(request)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\httpcore\\_async\\connection.py\", line 124, in _connect\n    stream = await self._network_backend.connect_tcp(**kwargs)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\httpcore\\_backends\\auto.py\", line 31, in connect_tcp\n    return await self._backend.connect_tcp(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...\u003c5 lines\u003e...\n    )\n    ^\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\httpcore\\_backends\\anyio.py\", line 113, in connect_tcp\n    with map_exceptions(exc_map):\n         ~~~~~~~~~~~~~~^^^^^^^^^\n  File \"C:\\Python314\\Lib\\contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\httpcore\\_exceptions.py\", line 14, in map_exceptions\n    raise to_exc(exc) from exc\nhttpcore.ConnectError: All connection attempts failed\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\opentelemetry\\trace\\__init__.py\", line 589, in use_span\n    yield span\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\opentelemetry\\sdk\\trace\\__init__.py\", line 1105, in start_as_current_span\n    yield span\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\opentelemetry\\instrumentation\\httpx\\__init__.py\", line 1241, in _handle_async_request_wrapper\n    raise exception.with_traceback(exception.__traceback__)\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\opentelemetry\\instrumentation\\httpx\\__init__.py\", line 1199, in _handle_async_request_wrapper\n    response = await wrapped(*args, **kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\httpx\\_transports\\default.py\", line 393, in handle_async_request\n    with map_httpcore_exceptions():\n         ~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"C:\\Python314\\Lib\\contextlib.py\", line 162, in __exit__\n    self.gen.throw(value)\n    ~~~~~~~~~~~~~~^^^^^^^\n  File \"D:\\Project\\wordloom-v3\\.venv\\Lib\\site-packages\\httpx\\_transports\\default.py\", line 118, in map_httpcore_exceptions\n    raise mapped_exc(message) from exc\nhttpx.ConnectError: All connection attempts failed\n"},{"key":"exception.type","type":"string","value":"httpx.ConnectError"}]}],"processID":"p1","warnings":null},{"traceID":"02c1b9f614e2439724b61a50775aa44c","spanID":"9a98f46e04018964","operationName":"outbox.process","references":[{"refType":"CHILD_OF","traceID":"02c1b9f614e2439724b61a50775aa44c","spanID":"221521188d31d666"}],"startTime":1770562251417138,"duration":2310775,"tags":[{"key":"otel.scope.name","type":"string","value":"wordloom.search_outbox_worker"},{"key":"span.kind","type":"string","value":"internal"},{"key":"wordloom.claim_batch_id","type":"string","value":"bd1aa12e-d551-45a9-929b-23514556aabc"},{"key":"wordloom.entity_id","type":"string","value":"b272ce7e-8cab-4a56-8ec1-9b3f35fd6706"},{"key":"wordloom.entity_type","type":"string","value":"book"},{"key":"wordloom.obs_schema","type":"string","value":"labs-009-v2"},{"key":"wordloom.outbox_attempts","type":"int64","value":5},{"key":"wordloom.outbox_event_id","type":"string","value":"3295b534-7d52-4160-87b2-570b510d168e"},{"key":"wordloom.outbox_event_version","type":"int64","value":1},{"key":"wordloom.outbox_op","type":"string","value":"delete"},{"key":"wordloom.projection","type":"string","value":"search_index_to_elastic"},{"key":"wordloom.worker_id","type":"string","value":"labs-009-expA-w1"}],"logs":[],"processID":"p1","warnings":null},{"traceID":"02c1b9f614e2439724b61a50775aa44c","spanID":"221521188d31d666","operationName":"projection.process_batch","references":[],"startTime":1770562251417041,"duration":2311207,"tags":[{"key":"attempt","type":"int64","value":5},{"key":"batch_size","type":"int64","value":1},{"key":"entity_type","type":"string","value":"book"},{"key":"failed_count","type":"int64","value":0},{"key":"ok_count","type":"int64","value":0},{"key":"op","type":"string","value":"delete"},{"key":"otel.scope.name","type":"string","value":"wordloom.search_outbox_worker"},{"key":"projection","type":"string","value":"search"},{"key":"reason","type":"string","value":"es_connect"},{"key":"result","type":"string","value":"retry"},{"key":"retry_count","type":"int64","value":1},{"key":"span.kind","type":"string","value":"internal"},{"key":"wordloom.claim_batch_id","type":"string","value":"bd1aa12e-d551-45a9-929b-23514556aabc"},{"key":"wordloom.obs_schema","type":"string","value":"labs-009-v2"},{"key":"wordloom.projection","type":"string","value":"search_index_to_elastic"},{"key":"wordloom.worker_id","type":"string","value":"labs-009-expA-w1"}],"logs":[],"processID":"p1","warnings":null},{"traceID":"02c1b9f614e2439724b61a50775aa44c","spanID":"e5194f3ff006d8f2","operationName":"connect","references":[{"refType":"CHILD_OF","traceID":"02c1b9f614e2439724b61a50775aa44c","spanID":"9a98f46e04018964"}],"startTime":1770562251417480,"duration":877,"tags":[{"key":"db.name","type":"string","value":"wordloom_test"},{"key":"db.system","type":"string","value":"postgresql"},{"key":"db.user","type":"string","value":"wordloom"},{"key":"net.peer.name","type":"string","value":"localhost"},{"key":"net.peer.port","type":"int64","value":5435},{"key":"otel.scope.name","type":"string","value":"opentelemetry.instrumentation.sqlalchemy"},{"key":"otel.scope.version","type":"string","value":"0.60b1"},{"key":"span.kind","type":"string","value":"client"}],"logs":[],"processID":"p1","warnings":null}],"processes":{"p1":{"serviceName":"wordloom-search-outbox-worker","tags":[{"key":"telemetry.sdk.language","type":"string","value":"python"},{"key":"telemetry.sdk.name","type":"string","value":"opentelemetry"},{"key":"telemetry.sdk.version","type":"string","value":"1.39.1"}]}},"warnings":null}],"total":0,"limit":0,"offset":0,"errors":null}
